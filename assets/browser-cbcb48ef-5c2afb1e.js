import{_ as _inherits,a as _createSuper,b as _classCallCheck,c as _createClass,r as require$$0,d as _wrapNativeSuper,e as _asyncToGenerator,f as _regeneratorRuntime,g as _typeof,h as require$$0$1,i as _objectSpread2,j as _createForOfIteratorHelper,k as _slicedToArray,l as _toConsumableArray}from"./index-ea6fe7ae.js";function _mergeNamespaces(m,i){return i.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(u){if(u!=="default"&&!(u in m)){var r=Object.getOwnPropertyDescriptor(t,u);Object.defineProperty(m,u,r.get?r:{enumerable:!0,get:function(){return t[u]}})}})}),Object.freeze(m)}var browser$2={exports:{}},lib$1={};Object.defineProperty(lib$1,"__esModule",{value:!0});lib$1.ReadableWebToNodeStream=void 0;var readable_stream_1=require$$0,ReadableWebToNodeStream=function(m){_inherits(t,m);var i=_createSuper(t);function t(u){var r;return _classCallCheck(this,t),r=i.call(this),r.bytesRead=0,r.released=!1,r.reader=u.getReader(),r}return _createClass(t,[{key:"_read",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){var f;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.released){s.next=3;break}return this.push(null),s.abrupt("return");case 3:return this.pendingRead=this.reader.read(),s.next=6,this.pendingRead;case 6:f=s.sent,delete this.pendingRead,f.done||this.released?this.push(null):(this.bytesRead+=f.value.length,this.push(f.value));case 9:case"end":return s.stop()}},a,this)}));function r(){return u.apply(this,arguments)}return r}()},{key:"waitForReadToComplete",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.pendingRead){n.next=3;break}return n.next=3,this.pendingRead;case 3:case"end":return n.stop()}},a,this)}));function r(){return u.apply(this,arguments)}return r}()},{key:"close",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.syncAndRelease();case 2:case"end":return n.stop()}},a,this)}));function r(){return u.apply(this,arguments)}return r}()},{key:"syncAndRelease",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.released=!0,n.next=3,this.waitForReadToComplete();case 3:return n.next=5,this.reader.releaseLock();case 5:case"end":return n.stop()}},a,this)}));function r(){return u.apply(this,arguments)}return r}()}]),t}(readable_stream_1.Readable);lib$1.ReadableWebToNodeStream=ReadableWebToNodeStream;var core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib={},EndOfFileStream={};(function(m){Object.defineProperty(m,"__esModule",{value:!0}),m.EndOfStreamError=m.defaultMessages=void 0,m.defaultMessages="End-Of-Stream";var i=function(t){_inherits(r,t);var u=_createSuper(r);function r(){return _classCallCheck(this,r),u.call(this,m.defaultMessages)}return _createClass(r)}(_wrapNativeSuper(Error));m.EndOfStreamError=i})(EndOfFileStream);var StreamReader={},Deferred$1={};Object.defineProperty(Deferred$1,"__esModule",{value:!0});Deferred$1.Deferred=void 0;var Deferred=_createClass(function m(){var i=this;_classCallCheck(this,m),this.resolve=function(){return null},this.reject=function(){return null},this.promise=new Promise(function(t,u){i.reject=u,i.resolve=t})});Deferred$1.Deferred=Deferred;(function(m){Object.defineProperty(m,"__esModule",{value:!0}),m.StreamReader=m.EndOfStreamError=void 0;var i=EndOfFileStream,t=Deferred$1,u=EndOfFileStream;Object.defineProperty(m,"EndOfStreamError",{enumerable:!0,get:function(){return u.EndOfStreamError}});var r=1*1024*1024,a=function(){function f(n){var s=this;if(_classCallCheck(this,f),this.s=n,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!n.read||!n.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",function(){return s.reject(new i.EndOfStreamError)}),this.s.once("error",function(d){return s.reject(d)}),this.s.once("close",function(){return s.reject(new Error("Stream closed"))})}return _createClass(f,[{key:"peek",value:function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,o,x){var l;return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.read(p,o,x);case 2:return l=h.sent,this.peekQueue.push(p.subarray(o,o+l)),h.abrupt("return",l);case 5:case"end":return h.stop()}},d,this)}));function s(d,p,o){return n.apply(this,arguments)}return s}()},{key:"read",value:function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,o,x){var l,y,h,B,T,R;return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(x!==0){g.next=2;break}return g.abrupt("return",0);case 2:if(!(this.peekQueue.length===0&&this.endOfStream)){g.next=4;break}throw new i.EndOfStreamError;case 4:l=x,y=0;case 6:if(!(this.peekQueue.length>0&&l>0)){g.next=17;break}if(h=this.peekQueue.pop(),h){g.next=10;break}throw new Error("peekData should be defined");case 10:B=Math.min(h.length,l),p.set(h.subarray(0,B),o+y),y+=B,l-=B,B<h.length&&this.peekQueue.push(h.subarray(B)),g.next=6;break;case 17:if(!(l>0&&!this.endOfStream)){g.next=28;break}return T=Math.min(l,r),g.next=21,this.readFromStream(p,o+y,T);case 21:if(R=g.sent,y+=R,!(R<T)){g.next=25;break}return g.abrupt("break",28);case 25:l-=R,g.next=17;break;case 28:return g.abrupt("return",y);case 29:case"end":return g.stop()}},d,this)}));function s(d,p,o){return n.apply(this,arguments)}return s}()},{key:"readFromStream",value:function(){var n=_asyncToGenerator(_regeneratorRuntime().mark(function d(p,o,x){var l=this,y,h;return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(y=this.s.read(x),!y){T.next=6;break}return p.set(y,o),T.abrupt("return",y.length);case 6:return h={buffer:p,offset:o,length:x,deferred:new t.Deferred},this.deferred=h.deferred,this.s.once("readable",function(){l.readDeferred(h)}),T.abrupt("return",h.deferred.promise);case 10:case"end":return T.stop()}},d,this)}));function s(d,p,o){return n.apply(this,arguments)}return s}()},{key:"readDeferred",value:function(s){var d=this,p=this.s.read(s.length);p?(s.buffer.set(p,s.offset),s.deferred.resolve(p.length),this.deferred=null):this.s.once("readable",function(){d.readDeferred(s)})}},{key:"reject",value:function(s){this.endOfStream=!0,this.deferred&&(this.deferred.reject(s),this.deferred=null)}}]),f}();m.StreamReader=a})(StreamReader);(function(m){Object.defineProperty(m,"__esModule",{value:!0}),m.StreamReader=m.EndOfStreamError=void 0;var i=EndOfFileStream;Object.defineProperty(m,"EndOfStreamError",{enumerable:!0,get:function(){return i.EndOfStreamError}});var t=StreamReader;Object.defineProperty(m,"StreamReader",{enumerable:!0,get:function(){return t.StreamReader}})})(lib);Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0});AbstractTokenizer$1.AbstractTokenizer=void 0;var peek_readable_1$2=lib,AbstractTokenizer=function(){function m(i){_classCallCheck(this,m),this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=i||{}}return _createClass(m,[{key:"readToken",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(r){var a,f,n,s=arguments;return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=s.length>1&&s[1]!==void 0?s[1]:this.position,f=Buffer.alloc(r.len),p.next=4,this.readBuffer(f,{position:a});case 4:if(n=p.sent,!(n<r.len)){p.next=7;break}throw new peek_readable_1$2.EndOfStreamError;case 7:return p.abrupt("return",r.get(f,0));case 8:case"end":return p.stop()}},u,this)}));function t(u){return i.apply(this,arguments)}return t}()},{key:"peekToken",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(r){var a,f,n,s=arguments;return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=s.length>1&&s[1]!==void 0?s[1]:this.position,f=Buffer.alloc(r.len),p.next=4,this.peekBuffer(f,{position:a});case 4:if(n=p.sent,!(n<r.len)){p.next=7;break}throw new peek_readable_1$2.EndOfStreamError;case 7:return p.abrupt("return",r.get(f,0));case 8:case"end":return p.stop()}},u,this)}));function t(u){return i.apply(this,arguments)}return t}()},{key:"readNumber",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(r){var a;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.readBuffer(this.numBuffer,{length:r.len});case 2:if(a=n.sent,!(a<r.len)){n.next=5;break}throw new peek_readable_1$2.EndOfStreamError;case 5:return n.abrupt("return",r.get(this.numBuffer,0));case 6:case"end":return n.stop()}},u,this)}));function t(u){return i.apply(this,arguments)}return t}()},{key:"peekNumber",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(r){var a;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.peekBuffer(this.numBuffer,{length:r.len});case 2:if(a=n.sent,!(a<r.len)){n.next=5;break}throw new peek_readable_1$2.EndOfStreamError;case 5:return n.abrupt("return",r.get(this.numBuffer,0));case 6:case"end":return n.stop()}},u,this)}));function t(u){return i.apply(this,arguments)}return t}()},{key:"ignore",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(r){var a;return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.fileInfo.size===void 0){n.next=5;break}if(a=this.fileInfo.size-this.position,!(r>a)){n.next=5;break}return this.position+=a,n.abrupt("return",a);case 5:return this.position+=r,n.abrupt("return",r);case 7:case"end":return n.stop()}},u,this)}));function t(u){return i.apply(this,arguments)}return t}()},{key:"close",value:function(){var i=_asyncToGenerator(_regeneratorRuntime().mark(function u(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},u)}));function t(){return i.apply(this,arguments)}return t}()},{key:"normalizeOptions",value:function(t,u){if(u&&u.position!==void 0&&u.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return u?{mayBeLess:u.mayBeLess===!0,offset:u.offset?u.offset:0,length:u.length?u.length:t.length-(u.offset?u.offset:0),position:u.position?u.position:this.position}:{mayBeLess:!1,offset:0,length:t.length,position:this.position}}}]),m}();AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer;Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0});ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;var AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib,maxBufferSize=256e3,ReadStreamTokenizer=function(m){_inherits(t,m);var i=_createSuper(t);function t(u,r){var a;return _classCallCheck(this,t),a=i.call(this,r),a.streamReader=new peek_readable_1$1.StreamReader(u),a}return _createClass(t,[{key:"getFileInfo",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.fileInfo);case 1:case"end":return n.stop()}},a,this)}));function r(){return u.apply(this,arguments)}return r}()},{key:"readBuffer",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(f,n){var s,d,p;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(s=this.normalizeOptions(f,n),d=s.position-this.position,!(d>0)){x.next=8;break}return x.next=5,this.ignore(d);case 5:return x.abrupt("return",this.readBuffer(f,n));case 8:if(!(d<0)){x.next=10;break}throw new Error("`options.position` must be equal or greater than `tokenizer.position`");case 10:if(s.length!==0){x.next=12;break}return x.abrupt("return",0);case 12:return x.next=14,this.streamReader.read(f,s.offset,s.length);case 14:if(p=x.sent,this.position+=p,!((!n||!n.mayBeLess)&&p<s.length)){x.next=18;break}throw new peek_readable_1$1.EndOfStreamError;case 18:return x.abrupt("return",p);case 19:case"end":return x.stop()}},a,this)}));function r(a,f){return u.apply(this,arguments)}return r}()},{key:"peekBuffer",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(f,n){var s,d,p,o;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(s=this.normalizeOptions(f,n),d=0,!s.position){l.next=15;break}if(p=s.position-this.position,!(p>0)){l.next=13;break}return o=new Uint8Array(s.length+p),l.next=8,this.peekBuffer(o,{mayBeLess:s.mayBeLess});case 8:return d=l.sent,f.set(o.subarray(p),s.offset),l.abrupt("return",d-p);case 13:if(!(p<0)){l.next=15;break}throw new Error("Cannot peek from a negative offset in a stream");case 15:if(!(s.length>0)){l.next=29;break}return l.prev=16,l.next=19,this.streamReader.peek(f,s.offset,s.length);case 19:d=l.sent,l.next=27;break;case 22:if(l.prev=22,l.t0=l.catch(16),!(n&&n.mayBeLess&&l.t0 instanceof peek_readable_1$1.EndOfStreamError)){l.next=26;break}return l.abrupt("return",0);case 26:throw l.t0;case 27:if(!(!s.mayBeLess&&d<s.length)){l.next=29;break}throw new peek_readable_1$1.EndOfStreamError;case 29:return l.abrupt("return",d);case 30:case"end":return l.stop()}},a,this,[[16,22]])}));function r(a,f){return u.apply(this,arguments)}return r}()},{key:"ignore",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(f){var n,s,d,p,o;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n=Math.min(maxBufferSize,f),s=new Uint8Array(n),d=0;case 3:if(!(d<f)){l.next=13;break}return p=f-d,l.next=7,this.readBuffer(s,{length:Math.min(n,p)});case 7:if(o=l.sent,!(o<0)){l.next=10;break}return l.abrupt("return",o);case 10:d+=o,l.next=3;break;case 13:return l.abrupt("return",d);case 14:case"end":return l.stop()}},a,this)}));function r(a){return u.apply(this,arguments)}return r}()}]),t}(AbstractTokenizer_1$1.AbstractTokenizer);ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0});BufferTokenizer$1.BufferTokenizer=void 0;var peek_readable_1=lib,AbstractTokenizer_1=AbstractTokenizer$1,BufferTokenizer=function(m){_inherits(t,m);var i=_createSuper(t);function t(u,r){var a;return _classCallCheck(this,t),a=i.call(this,r),a.uint8Array=u,a.fileInfo.size=a.fileInfo.size?a.fileInfo.size:u.length,a}return _createClass(t,[{key:"readBuffer",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(f,n){var s;return _regeneratorRuntime().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(n&&n.position)){p.next=4;break}if(!(n.position<this.position)){p.next=3;break}throw new Error("`options.position` must be equal or greater than `tokenizer.position`");case 3:this.position=n.position;case 4:return p.next=6,this.peekBuffer(f,n);case 6:return s=p.sent,this.position+=s,p.abrupt("return",s);case 9:case"end":return p.stop()}},a,this)}));function r(a,f){return u.apply(this,arguments)}return r}()},{key:"peekBuffer",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(f,n){var s,d;return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(s=this.normalizeOptions(f,n),d=Math.min(this.uint8Array.length-s.position,s.length),!(!s.mayBeLess&&d<s.length)){o.next=6;break}throw new peek_readable_1.EndOfStreamError;case 6:return f.set(this.uint8Array.subarray(s.position,s.position+d),s.offset),o.abrupt("return",d);case 8:case"end":return o.stop()}},a,this)}));function r(a,f){return u.apply(this,arguments)}return r}()},{key:"close",value:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function a(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}()}]),t}(AbstractTokenizer_1.AbstractTokenizer);BufferTokenizer$1.BufferTokenizer=BufferTokenizer;(function(m){Object.defineProperty(m,"__esModule",{value:!0}),m.fromBuffer=m.fromStream=m.EndOfStreamError=void 0;var i=ReadStreamTokenizer$1,t=BufferTokenizer$1,u=lib;Object.defineProperty(m,"EndOfStreamError",{enumerable:!0,get:function(){return u.EndOfStreamError}});function r(f,n){return n=n||{},new i.ReadStreamTokenizer(f,n)}m.fromStream=r;function a(f,n){return new t.BufferTokenizer(f,n)}m.fromBuffer=a})(core$1);var util={};util.stringToBytes=function(m){return _toConsumableArray(m).map(function(i){return i.charCodeAt(0)})};util.tarHeaderChecksumMatches=function(m){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=parseInt(m.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(t))return!1;for(var u=8*32,r=i;r<i+148;r++)u+=m[r];for(var a=i+156;a<i+512;a++)u+=m[a];return t===u};util.uint32SyncSafeToken={get:function(i,t){return i[t+3]&127|i[t+2]<<7|i[t+1]<<14|i[t]<<21},len:4};var supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]},Token=require$$0$1,strtok3=core$1,stringToBytes=util.stringToBytes,tarHeaderChecksumMatches=util.tarHeaderChecksumMatches,uint32SyncSafeToken=util.uint32SyncSafeToken,supported=supported$1,minimumBytes=4100;function fromStream(m){return _fromStream.apply(this,arguments)}function _fromStream(){return _fromStream=_asyncToGenerator(_regeneratorRuntime().mark(function m(i){var t;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,strtok3.fromStream(i);case 2:return t=r.sent,r.prev=3,r.next=6,fromTokenizer(t);case 6:return r.abrupt("return",r.sent);case 7:return r.prev=7,r.next=10,t.close();case 10:return r.finish(7);case 11:case"end":return r.stop()}},m,null,[[3,,7,11]])})),_fromStream.apply(this,arguments)}function fromBuffer(m){return _fromBuffer.apply(this,arguments)}function _fromBuffer(){return _fromBuffer=_asyncToGenerator(_regeneratorRuntime().mark(function m(i){var t,u;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i instanceof Uint8Array||i instanceof ArrayBuffer||Buffer.isBuffer(i)){a.next=2;break}throw new TypeError("Expected the `input` argument to be of type `Uint8Array` or `Buffer` or `ArrayBuffer`, got `".concat(_typeof(i),"`"));case 2:if(t=i instanceof Buffer?i:Buffer.from(i),t&&t.length>1){a.next=5;break}return a.abrupt("return");case 5:return u=strtok3.fromBuffer(t),a.abrupt("return",fromTokenizer(u));case 7:case"end":return a.stop()}},m)})),_fromBuffer.apply(this,arguments)}function _check(m,i,t){t=_objectSpread2({offset:0},t);var u=_createForOfIteratorHelper(i.entries()),r;try{for(u.s();!(r=u.n()).done;){var a=_slicedToArray(r.value,2),f=a[0],n=a[1];if(t.mask){if(n!==(t.mask[f]&m[f+t.offset]))return!1}else if(n!==m[f+t.offset])return!1}}catch(s){u.e(s)}finally{u.f()}return!0}function fromTokenizer(m){return _fromTokenizer2.apply(this,arguments)}function _fromTokenizer2(){return _fromTokenizer2=_asyncToGenerator(_regeneratorRuntime().mark(function m(i){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.abrupt("return",_fromTokenizer(i));case 4:if(u.prev=4,u.t0=u.catch(0),u.t0 instanceof strtok3.EndOfStreamError){u.next=8;break}throw u.t0;case 8:case"end":return u.stop()}},m,null,[[0,4]])})),_fromTokenizer2.apply(this,arguments)}function _fromTokenizer(m){return _fromTokenizer3.apply(this,arguments)}function _fromTokenizer3(){return _fromTokenizer3=_asyncToGenerator(_regeneratorRuntime().mark(function m(i){var t,u,r,a,f,n,s,d,p,o,x,l,y,h,B,T,R,O,g,j,$,M,D,z,A,I,C,L,P;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Buffer.alloc(minimumBytes),u=12,r=function(v,w){return _check(t,v,w)},a=function(v,w){return r(stringToBytes(v),w)},i.fileInfo.size||(i.fileInfo.size=Number.MAX_SAFE_INTEGER),e.next=7,i.peekBuffer(t,{length:u,mayBeLess:!0});case 7:if(!r([66,77])){e.next=9;break}return e.abrupt("return",{ext:"bmp",mime:"image/bmp"});case 9:if(!r([11,119])){e.next=11;break}return e.abrupt("return",{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"});case 11:if(!r([120,1])){e.next=13;break}return e.abrupt("return",{ext:"dmg",mime:"application/x-apple-diskimage"});case 13:if(!r([77,90])){e.next=15;break}return e.abrupt("return",{ext:"exe",mime:"application/x-msdownload"});case 15:if(!r([37,33])){e.next=21;break}return e.next=18,i.peekBuffer(t,{length:24,mayBeLess:!0});case 18:if(!(a("PS-Adobe-",{offset:2})&&a(" EPSF-",{offset:14}))){e.next=20;break}return e.abrupt("return",{ext:"eps",mime:"application/eps"});case 20:return e.abrupt("return",{ext:"ps",mime:"application/postscript"});case 21:if(!(r([31,160])||r([31,157]))){e.next=23;break}return e.abrupt("return",{ext:"Z",mime:"application/x-compress"});case 23:if(!r([255,216,255])){e.next=25;break}return e.abrupt("return",{ext:"jpg",mime:"image/jpeg"});case 25:if(!r([73,73,188])){e.next=27;break}return e.abrupt("return",{ext:"jxr",mime:"image/vnd.ms-photo"});case 27:if(!r([31,139,8])){e.next=29;break}return e.abrupt("return",{ext:"gz",mime:"application/gzip"});case 29:if(!r([66,90,104])){e.next=31;break}return e.abrupt("return",{ext:"bz2",mime:"application/x-bzip2"});case 31:if(!a("ID3")){e.next=42;break}return e.next=34,i.ignore(6);case 34:return e.next=36,i.readToken(uint32SyncSafeToken);case 36:if(f=e.sent,!(i.position+f>i.fileInfo.size)){e.next=39;break}return e.abrupt("return",{ext:"mp3",mime:"audio/mpeg"});case 39:return e.next=41,i.ignore(f);case 41:return e.abrupt("return",fromTokenizer(i));case 42:if(!a("MP+")){e.next=44;break}return e.abrupt("return",{ext:"mpc",mime:"audio/x-musepack"});case 44:if(!((t[0]===67||t[0]===70)&&r([87,83],{offset:1}))){e.next=46;break}return e.abrupt("return",{ext:"swf",mime:"application/x-shockwave-flash"});case 46:if(!r([71,73,70])){e.next=48;break}return e.abrupt("return",{ext:"gif",mime:"image/gif"});case 48:if(!a("FLIF")){e.next=50;break}return e.abrupt("return",{ext:"flif",mime:"image/flif"});case 50:if(!a("8BPS")){e.next=52;break}return e.abrupt("return",{ext:"psd",mime:"image/vnd.adobe.photoshop"});case 52:if(!a("WEBP",{offset:8})){e.next=54;break}return e.abrupt("return",{ext:"webp",mime:"image/webp"});case 54:if(!a("MPCK")){e.next=56;break}return e.abrupt("return",{ext:"mpc",mime:"audio/x-musepack"});case 56:if(!a("FORM")){e.next=58;break}return e.abrupt("return",{ext:"aif",mime:"audio/aiff"});case 58:if(!a("icns",{offset:0})){e.next=60;break}return e.abrupt("return",{ext:"icns",mime:"image/icns"});case 60:if(!r([80,75,3,4])){e.next=121;break}e.prev=61;case 62:if(!(i.position+30<i.fileInfo.size)){e.next=114;break}return e.next=65,i.readBuffer(t,{length:30});case 65:return n={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)},e.next=68,i.readToken(new Token.StringType(n.filenameLength,"utf-8"));case 68:return n.filename=e.sent,e.next=71,i.ignore(n.extraFieldLength);case 71:if(n.filename!=="META-INF/mozilla.rsa"){e.next=73;break}return e.abrupt("return",{ext:"xpi",mime:"application/x-xpinstall"});case 73:if(!(n.filename.endsWith(".rels")||n.filename.endsWith(".xml"))){e.next=83;break}s=n.filename.split("/")[0],e.t0=s,e.next=e.t0==="_rels"?78:e.t0==="word"?79:e.t0==="ppt"?80:e.t0==="xl"?81:82;break;case 78:return e.abrupt("break",83);case 79:return e.abrupt("return",{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});case 80:return e.abrupt("return",{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"});case 81:return e.abrupt("return",{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});case 82:return e.abrupt("break",83);case 83:if(!n.filename.startsWith("xl/")){e.next=85;break}return e.abrupt("return",{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});case 85:if(!(n.filename.startsWith("3D/")&&n.filename.endsWith(".model"))){e.next=87;break}return e.abrupt("return",{ext:"3mf",mime:"model/3mf"});case 87:if(!(n.filename==="mimetype"&&n.compressedSize===n.uncompressedSize)){e.next=98;break}return e.next=90,i.readToken(new Token.StringType(n.compressedSize,"utf-8"));case 90:d=e.sent,e.t1=d,e.next=e.t1==="application/epub+zip"?94:e.t1==="application/vnd.oasis.opendocument.text"?95:e.t1==="application/vnd.oasis.opendocument.spreadsheet"?96:e.t1==="application/vnd.oasis.opendocument.presentation"?97:98;break;case 94:return e.abrupt("return",{ext:"epub",mime:"application/epub+zip"});case 95:return e.abrupt("return",{ext:"odt",mime:"application/vnd.oasis.opendocument.text"});case 96:return e.abrupt("return",{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"});case 97:return e.abrupt("return",{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"});case 98:if(n.compressedSize!==0){e.next=110;break}p=-1;case 100:if(!(p<0&&i.position<i.fileInfo.size)){e.next=108;break}return e.next=103,i.peekBuffer(t,{mayBeLess:!0});case 103:return p=t.indexOf("504B0304",0,"hex"),e.next=106,i.ignore(p>=0?p:t.length);case 106:e.next=100;break;case 108:e.next=112;break;case 110:return e.next=112,i.ignore(n.compressedSize);case 112:e.next=62;break;case 114:e.next=120;break;case 116:if(e.prev=116,e.t2=e.catch(61),e.t2 instanceof strtok3.EndOfStreamError){e.next=120;break}throw e.t2;case 120:return e.abrupt("return",{ext:"zip",mime:"application/zip"});case 121:if(!a("OggS")){e.next=140;break}return e.next=124,i.ignore(28);case 124:return o=Buffer.alloc(8),e.next=127,i.readBuffer(o);case 127:if(!_check(o,[79,112,117,115,72,101,97,100])){e.next=129;break}return e.abrupt("return",{ext:"opus",mime:"audio/opus"});case 129:if(!_check(o,[128,116,104,101,111,114,97])){e.next=131;break}return e.abrupt("return",{ext:"ogv",mime:"video/ogg"});case 131:if(!_check(o,[1,118,105,100,101,111,0])){e.next=133;break}return e.abrupt("return",{ext:"ogm",mime:"video/ogg"});case 133:if(!_check(o,[127,70,76,65,67])){e.next=135;break}return e.abrupt("return",{ext:"oga",mime:"audio/ogg"});case 135:if(!_check(o,[83,112,101,101,120,32,32])){e.next=137;break}return e.abrupt("return",{ext:"spx",mime:"audio/ogg"});case 137:if(!_check(o,[1,118,111,114,98,105,115])){e.next=139;break}return e.abrupt("return",{ext:"ogg",mime:"audio/ogg"});case 139:return e.abrupt("return",{ext:"ogx",mime:"application/ogg"});case 140:if(!(r([80,75])&&(t[2]===3||t[2]===5||t[2]===7)&&(t[3]===4||t[3]===6||t[3]===8))){e.next=142;break}return e.abrupt("return",{ext:"zip",mime:"application/zip"});case 142:if(!(a("ftyp",{offset:4})&&t[8]&96)){e.next=167;break}x=t.toString("binary",8,12).replace("\0"," ").trim(),e.t3=x,e.next=e.t3==="avif"?147:e.t3==="mif1"?148:e.t3==="msf1"?149:e.t3==="heic"||e.t3==="heix"?150:e.t3==="hevc"||e.t3==="hevx"?151:e.t3==="qt"?152:e.t3==="M4V"||e.t3==="M4VH"||e.t3==="M4VP"?153:e.t3==="M4P"?154:e.t3==="M4B"?155:e.t3==="M4A"?156:e.t3==="F4V"?157:e.t3==="F4P"?158:e.t3==="F4A"?159:e.t3==="F4B"?160:e.t3==="crx"?161:162;break;case 147:return e.abrupt("return",{ext:"avif",mime:"image/avif"});case 148:return e.abrupt("return",{ext:"heic",mime:"image/heif"});case 149:return e.abrupt("return",{ext:"heic",mime:"image/heif-sequence"});case 150:return e.abrupt("return",{ext:"heic",mime:"image/heic"});case 151:return e.abrupt("return",{ext:"heic",mime:"image/heic-sequence"});case 152:return e.abrupt("return",{ext:"mov",mime:"video/quicktime"});case 153:return e.abrupt("return",{ext:"m4v",mime:"video/x-m4v"});case 154:return e.abrupt("return",{ext:"m4p",mime:"video/mp4"});case 155:return e.abrupt("return",{ext:"m4b",mime:"audio/mp4"});case 156:return e.abrupt("return",{ext:"m4a",mime:"audio/x-m4a"});case 157:return e.abrupt("return",{ext:"f4v",mime:"video/mp4"});case 158:return e.abrupt("return",{ext:"f4p",mime:"video/mp4"});case 159:return e.abrupt("return",{ext:"f4a",mime:"audio/mp4"});case 160:return e.abrupt("return",{ext:"f4b",mime:"audio/mp4"});case 161:return e.abrupt("return",{ext:"cr3",mime:"image/x-canon-cr3"});case 162:if(!x.startsWith("3g")){e.next=166;break}if(!x.startsWith("3g2")){e.next=165;break}return e.abrupt("return",{ext:"3g2",mime:"video/3gpp2"});case 165:return e.abrupt("return",{ext:"3gp",mime:"video/3gpp"});case 166:return e.abrupt("return",{ext:"mp4",mime:"video/mp4"});case 167:if(!a("MThd")){e.next=169;break}return e.abrupt("return",{ext:"mid",mime:"audio/midi"});case 169:if(!(a("wOFF")&&(r([0,1,0,0],{offset:4})||a("OTTO",{offset:4})))){e.next=171;break}return e.abrupt("return",{ext:"woff",mime:"font/woff"});case 171:if(!(a("wOF2")&&(r([0,1,0,0],{offset:4})||a("OTTO",{offset:4})))){e.next=173;break}return e.abrupt("return",{ext:"woff2",mime:"font/woff2"});case 173:if(!(r([212,195,178,161])||r([161,178,195,212]))){e.next=175;break}return e.abrupt("return",{ext:"pcap",mime:"application/vnd.tcpdump.pcap"});case 175:if(!a("DSD ")){e.next=177;break}return e.abrupt("return",{ext:"dsf",mime:"audio/x-dsf"});case 177:if(!a("LZIP")){e.next=179;break}return e.abrupt("return",{ext:"lz",mime:"application/x-lzip"});case 179:if(!a("fLaC")){e.next=181;break}return e.abrupt("return",{ext:"flac",mime:"audio/x-flac"});case 181:if(!r([66,80,71,251])){e.next=183;break}return e.abrupt("return",{ext:"bpg",mime:"image/bpg"});case 183:if(!a("wvpk")){e.next=185;break}return e.abrupt("return",{ext:"wv",mime:"audio/wavpack"});case 185:if(!a("%PDF")){e.next=195;break}return e.next=188,i.ignore(1350);case 188:return l=10*1024*1024,y=Buffer.alloc(Math.min(l,i.fileInfo.size)),e.next=192,i.readBuffer(y,{mayBeLess:!0});case 192:if(!y.includes(Buffer.from("AIPrivateData"))){e.next=194;break}return e.abrupt("return",{ext:"ai",mime:"application/postscript"});case 194:return e.abrupt("return",{ext:"pdf",mime:"application/pdf"});case 195:if(!r([0,97,115,109])){e.next=197;break}return e.abrupt("return",{ext:"wasm",mime:"application/wasm"});case 197:if(!r([73,73,42,0])){e.next=210;break}if(!a("CR",{offset:8})){e.next=200;break}return e.abrupt("return",{ext:"cr2",mime:"image/x-canon-cr2"});case 200:if(!(r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8}))){e.next=202;break}return e.abrupt("return",{ext:"nef",mime:"image/x-nikon-nef"});case 202:if(!(r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8})))){e.next=204;break}return e.abrupt("return",{ext:"dng",mime:"image/x-adobe-dng"});case 204:return t=Buffer.alloc(24),e.next=207,i.peekBuffer(t);case 207:if(!((r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9}))){e.next=209;break}return e.abrupt("return",{ext:"arw",mime:"image/x-sony-arw"});case 209:return e.abrupt("return",{ext:"tif",mime:"image/tiff"});case 210:if(!r([77,77,0,42])){e.next=212;break}return e.abrupt("return",{ext:"tif",mime:"image/tiff"});case 212:if(!a("MAC ")){e.next=214;break}return e.abrupt("return",{ext:"ape",mime:"audio/ape"});case 214:if(!r([26,69,223,163])){e.next=230;break}return h=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function v(){var w,b,c,F;return _regeneratorRuntime().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,i.peekNumber(Token.UINT8);case 2:for(w=E.sent,b=128,c=0;!(w&b);)++c,b>>=1;return F=Buffer.alloc(c+1),E.next=9,i.readBuffer(F);case 9:return E.abrupt("return",F);case 10:case"end":return E.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),B=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function v(){var w,b,c;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,h();case 2:return w=k.sent,k.next=5,h();case 5:return b=k.sent,b[0]^=128>>b.length-1,c=Math.min(6,b.length),k.abrupt("return",{id:w.readUIntBE(0,w.length),len:b.readUIntBE(b.length-c,c)});case 9:case"end":return k.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),T=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function v(w,b){var c;return _regeneratorRuntime().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!(b>0)){k.next=11;break}return k.next=3,B();case 3:if(c=k.sent,c.id!==17026){k.next=6;break}return k.abrupt("return",i.readToken(new Token.StringType(c.len,"utf-8")));case 6:return k.next=8,i.ignore(c.len);case 8:--b,k.next=0;break;case 11:case"end":return k.stop()}},v)}));return function(w,b){return S.apply(this,arguments)}}(),e.next=220,B();case 220:return R=e.sent,e.next=223,T(1,R.len);case 223:O=e.sent,e.t4=O,e.next=e.t4==="webm"?227:e.t4==="matroska"?228:229;break;case 227:return e.abrupt("return",{ext:"webm",mime:"video/webm"});case 228:return e.abrupt("return",{ext:"mkv",mime:"video/x-matroska"});case 229:return e.abrupt("return");case 230:if(!r([82,73,70,70])){e.next=237;break}if(!r([65,86,73],{offset:8})){e.next=233;break}return e.abrupt("return",{ext:"avi",mime:"video/vnd.avi"});case 233:if(!r([87,65,86,69],{offset:8})){e.next=235;break}return e.abrupt("return",{ext:"wav",mime:"audio/vnd.wave"});case 235:if(!r([81,76,67,77],{offset:8})){e.next=237;break}return e.abrupt("return",{ext:"qcp",mime:"audio/qcelp"});case 237:if(!a("SQLi")){e.next=239;break}return e.abrupt("return",{ext:"sqlite",mime:"application/x-sqlite3"});case 239:if(!r([78,69,83,26])){e.next=241;break}return e.abrupt("return",{ext:"nes",mime:"application/x-nintendo-nes-rom"});case 241:if(!a("Cr24")){e.next=243;break}return e.abrupt("return",{ext:"crx",mime:"application/x-google-chrome-extension"});case 243:if(!(a("MSCF")||a("ISc("))){e.next=245;break}return e.abrupt("return",{ext:"cab",mime:"application/vnd.ms-cab-compressed"});case 245:if(!r([237,171,238,219])){e.next=247;break}return e.abrupt("return",{ext:"rpm",mime:"application/x-rpm"});case 247:if(!r([197,208,211,198])){e.next=249;break}return e.abrupt("return",{ext:"eps",mime:"application/eps"});case 249:if(!r([40,181,47,253])){e.next=251;break}return e.abrupt("return",{ext:"zst",mime:"application/zstd"});case 251:if(!r([79,84,84,79,0])){e.next=253;break}return e.abrupt("return",{ext:"otf",mime:"font/otf"});case 253:if(!a("#!AMR")){e.next=255;break}return e.abrupt("return",{ext:"amr",mime:"audio/amr"});case 255:if(!a("{\\rtf")){e.next=257;break}return e.abrupt("return",{ext:"rtf",mime:"application/rtf"});case 257:if(!r([70,76,86,1])){e.next=259;break}return e.abrupt("return",{ext:"flv",mime:"video/x-flv"});case 259:if(!a("IMPM")){e.next=261;break}return e.abrupt("return",{ext:"it",mime:"audio/x-it"});case 261:if(!(a("-lh0-",{offset:2})||a("-lh1-",{offset:2})||a("-lh2-",{offset:2})||a("-lh3-",{offset:2})||a("-lh4-",{offset:2})||a("-lh5-",{offset:2})||a("-lh6-",{offset:2})||a("-lh7-",{offset:2})||a("-lzs-",{offset:2})||a("-lz4-",{offset:2})||a("-lz5-",{offset:2})||a("-lhd-",{offset:2}))){e.next=263;break}return e.abrupt("return",{ext:"lzh",mime:"application/x-lzh-compressed"});case 263:if(!r([0,0,1,186])){e.next=268;break}if(!r([33],{offset:4,mask:[241]})){e.next=266;break}return e.abrupt("return",{ext:"mpg",mime:"video/MP1S"});case 266:if(!r([68],{offset:4,mask:[196]})){e.next=268;break}return e.abrupt("return",{ext:"mpg",mime:"video/MP2P"});case 268:if(!a("ITSF")){e.next=270;break}return e.abrupt("return",{ext:"chm",mime:"application/vnd.ms-htmlhelp"});case 270:if(!r([253,55,122,88,90,0])){e.next=272;break}return e.abrupt("return",{ext:"xz",mime:"application/x-xz"});case 272:if(!a("<?xml ")){e.next=274;break}return e.abrupt("return",{ext:"xml",mime:"application/xml"});case 274:if(!r([55,122,188,175,39,28])){e.next=276;break}return e.abrupt("return",{ext:"7z",mime:"application/x-7z-compressed"});case 276:if(!(r([82,97,114,33,26,7])&&(t[6]===0||t[6]===1))){e.next=278;break}return e.abrupt("return",{ext:"rar",mime:"application/x-rar-compressed"});case 278:if(!a("solid ")){e.next=280;break}return e.abrupt("return",{ext:"stl",mime:"model/stl"});case 280:if(!a("BLENDER")){e.next=282;break}return e.abrupt("return",{ext:"blend",mime:"application/x-blender"});case 282:if(!a("!<arch>")){e.next=291;break}return e.next=285,i.ignore(8);case 285:return e.next=287,i.readToken(new Token.StringType(13,"ascii"));case 287:if(g=e.sent,g!=="debian-binary"){e.next=290;break}return e.abrupt("return",{ext:"deb",mime:"application/x-deb"});case 290:return e.abrupt("return",{ext:"ar",mime:"application/x-unix-archive"});case 291:if(!r([137,80,78,71,13,10,26,10])){e.next=309;break}return j=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function v(){return _regeneratorRuntime().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,i.readToken(Token.INT32_BE);case 2:return b.t0=b.sent,b.next=5,i.readToken(new Token.StringType(4,"binary"));case 5:return b.t1=b.sent,b.abrupt("return",{length:b.t0,type:b.t1});case 7:case"end":return b.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),e.next=295,i.ignore(8);case 295:return e.next=297,j();case 297:if($=e.sent,!($.length<0)){e.next=300;break}return e.abrupt("return");case 300:e.t5=$.type,e.next=e.t5==="IDAT"?303:e.t5==="acTL"?304:305;break;case 303:return e.abrupt("return",{ext:"png",mime:"image/png"});case 304:return e.abrupt("return",{ext:"apng",mime:"image/apng"});case 305:return e.next=307,i.ignore($.length+4);case 307:if(i.position+8<i.fileInfo.size){e.next=295;break}case 308:return e.abrupt("return",{ext:"png",mime:"image/png"});case 309:if(!r([65,82,82,79,87,49,0,0])){e.next=311;break}return e.abrupt("return",{ext:"arrow",mime:"application/x-apache-arrow"});case 311:if(!r([103,108,84,70,2,0,0,0])){e.next=313;break}return e.abrupt("return",{ext:"glb",mime:"model/gltf-binary"});case 313:if(!(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))){e.next=315;break}return e.abrupt("return",{ext:"mov",mime:"video/quicktime"});case 315:if(!r([73,73,82,79,8,0,0,0,24])){e.next=317;break}return e.abrupt("return",{ext:"orf",mime:"image/x-olympus-orf"});case 317:if(!a("gimp xcf ")){e.next=319;break}return e.abrupt("return",{ext:"xcf",mime:"image/x-xcf"});case 319:if(!r([73,73,85,0,24,0,0,0,136,231,116,216])){e.next=321;break}return e.abrupt("return",{ext:"rw2",mime:"image/x-panasonic-rw2"});case 321:if(!r([48,38,178,117,142,102,207,17,166,217])){e.next=346;break}return M=function(){var S=_asyncToGenerator(_regeneratorRuntime().mark(function v(){var w;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return w=Buffer.alloc(16),c.next=3,i.readBuffer(w);case 3:return c.t0=w,c.t1=Number,c.next=7,i.readToken(Token.UINT64_LE);case 7:return c.t2=c.sent,c.t3=(0,c.t1)(c.t2),c.abrupt("return",{id:c.t0,size:c.t3});case 10:case"end":return c.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),e.next=325,i.ignore(30);case 325:if(!(i.position+24<i.fileInfo.size)){e.next=345;break}return e.next=328,M();case 328:if(D=e.sent,z=D.size-24,!_check(D.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){e.next=341;break}return A=Buffer.alloc(16),e.t6=z,e.next=335,i.readBuffer(A);case 335:if(z=e.t6-=e.sent,!_check(A,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43])){e.next=338;break}return e.abrupt("return",{ext:"asf",mime:"audio/x-ms-asf"});case 338:if(!_check(A,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43])){e.next=340;break}return e.abrupt("return",{ext:"asf",mime:"video/x-ms-asf"});case 340:return e.abrupt("break",345);case 341:return e.next=343,i.ignore(z);case 343:e.next=325;break;case 345:return e.abrupt("return",{ext:"asf",mime:"application/vnd.ms-asf"});case 346:if(!r([171,75,84,88,32,49,49,187,13,10,26,10])){e.next=348;break}return e.abrupt("return",{ext:"ktx",mime:"image/ktx"});case 348:if(!((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))){e.next=350;break}return e.abrupt("return",{ext:"mie",mime:"application/x-mie"});case 350:if(!r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2})){e.next=352;break}return e.abrupt("return",{ext:"shp",mime:"application/x-esri-shape"});case 352:if(!r([0,0,0,12,106,80,32,32,13,10,135,10])){e.next=366;break}return e.next=355,i.ignore(20);case 355:return e.next=357,i.readToken(new Token.StringType(4,"ascii"));case 357:I=e.sent,e.t7=I,e.next=e.t7==="jp2 "?361:e.t7==="jpx "?362:e.t7==="jpm "?363:e.t7==="mjp2"?364:365;break;case 361:return e.abrupt("return",{ext:"jp2",mime:"image/jp2"});case 362:return e.abrupt("return",{ext:"jpx",mime:"image/jpx"});case 363:return e.abrupt("return",{ext:"jpm",mime:"image/jpm"});case 364:return e.abrupt("return",{ext:"mj2",mime:"image/mj2"});case 365:return e.abrupt("return");case 366:if(!(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))){e.next=368;break}return e.abrupt("return",{ext:"jxl",mime:"image/jxl"});case 368:if(!(r([0,0,1,186])||r([0,0,1,179]))){e.next=370;break}return e.abrupt("return",{ext:"mpg",mime:"video/mpeg"});case 370:if(!r([0,1,0,0,0])){e.next=372;break}return e.abrupt("return",{ext:"ttf",mime:"font/ttf"});case 372:if(!r([0,0,1,0])){e.next=374;break}return e.abrupt("return",{ext:"ico",mime:"image/x-icon"});case 374:if(!r([0,0,2,0])){e.next=376;break}return e.abrupt("return",{ext:"cur",mime:"image/x-icon"});case 376:if(!r([208,207,17,224,161,177,26,225])){e.next=378;break}return e.abrupt("return",{ext:"cfb",mime:"application/x-cfb"});case 378:return e.next=380,i.peekBuffer(t,{length:Math.min(256,i.fileInfo.size),mayBeLess:!0});case 380:if(!a("BEGIN:")){e.next=385;break}if(!a("VCARD",{offset:6})){e.next=383;break}return e.abrupt("return",{ext:"vcf",mime:"text/vcard"});case 383:if(!a("VCALENDAR",{offset:6})){e.next=385;break}return e.abrupt("return",{ext:"ics",mime:"text/calendar"});case 385:if(!a("FUJIFILMCCD-RAW")){e.next=387;break}return e.abrupt("return",{ext:"raf",mime:"image/x-fujifilm-raf"});case 387:if(!a("Extended Module:")){e.next=389;break}return e.abrupt("return",{ext:"xm",mime:"audio/x-xm"});case 389:if(!a("Creative Voice File")){e.next=391;break}return e.abrupt("return",{ext:"voc",mime:"audio/x-voc"});case 391:if(!(r([4,0,0,0])&&t.length>=16)){e.next=403;break}if(C=t.readUInt32LE(12),!(C>12&&t.length>=C+16)){e.next=403;break}if(e.prev=394,L=t.slice(16,C+16).toString(),P=JSON.parse(L),!P.files){e.next=399;break}return e.abrupt("return",{ext:"asar",mime:"application/x-asar"});case 399:e.next=403;break;case 401:e.prev=401,e.t8=e.catch(394);case 403:if(!r([6,14,43,52,2,5,1,1,13,1,2,1,1,2])){e.next=405;break}return e.abrupt("return",{ext:"mxf",mime:"application/mxf"});case 405:if(!a("SCRM",{offset:44})){e.next=407;break}return e.abrupt("return",{ext:"s3m",mime:"audio/x-s3m"});case 407:if(!(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))){e.next=409;break}return e.abrupt("return",{ext:"mts",mime:"video/mp2t"});case 409:if(!r([66,79,79,75,77,79,66,73],{offset:60})){e.next=411;break}return e.abrupt("return",{ext:"mobi",mime:"application/x-mobipocket-ebook"});case 411:if(!r([68,73,67,77],{offset:128})){e.next=413;break}return e.abrupt("return",{ext:"dcm",mime:"application/dicom"});case 413:if(!r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70])){e.next=415;break}return e.abrupt("return",{ext:"lnk",mime:"application/x.ms.shortcut"});case 415:if(!r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0])){e.next=417;break}return e.abrupt("return",{ext:"alias",mime:"application/x.apple.alias"});case 417:if(!(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))){e.next=419;break}return e.abrupt("return",{ext:"eot",mime:"application/vnd.ms-fontobject"});case 419:if(!r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29])){e.next=421;break}return e.abrupt("return",{ext:"indd",mime:"application/x-indesign"});case 421:return e.next=423,i.peekBuffer(t,{length:Math.min(512,i.fileInfo.size),mayBeLess:!0});case 423:if(!tarHeaderChecksumMatches(t)){e.next=425;break}return e.abrupt("return",{ext:"tar",mime:"application/x-tar"});case 425:if(!r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0])){e.next=427;break}return e.abrupt("return",{ext:"skp",mime:"application/vnd.sketchup.skp"});case 427:if(!a("-----BEGIN PGP MESSAGE-----")){e.next=429;break}return e.abrupt("return",{ext:"pgp",mime:"application/pgp-encrypted"});case 429:if(!(t.length>=2&&r([255,224],{offset:0,mask:[255,224]}))){e.next=440;break}if(!r([16],{offset:1,mask:[22]})){e.next=434;break}if(!r([8],{offset:1,mask:[8]})){e.next=433;break}return e.abrupt("return",{ext:"aac",mime:"audio/aac"});case 433:return e.abrupt("return",{ext:"aac",mime:"audio/aac"});case 434:if(!r([2],{offset:1,mask:[6]})){e.next=436;break}return e.abrupt("return",{ext:"mp3",mime:"audio/mpeg"});case 436:if(!r([4],{offset:1,mask:[6]})){e.next=438;break}return e.abrupt("return",{ext:"mp2",mime:"audio/mpeg"});case 438:if(!r([6],{offset:1,mask:[6]})){e.next=440;break}return e.abrupt("return",{ext:"mp1",mime:"audio/mpeg"});case 440:case"end":return e.stop()}},m,null,[[61,116],[394,401]])})),_fromTokenizer3.apply(this,arguments)}var stream=function stream(readableStream){return new Promise(function(resolve,reject){var stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",_asyncToGenerator(_regeneratorRuntime().mark(function m(){var i,t,u,r;return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i=new stream.PassThrough,stream.pipeline?t=stream.pipeline(readableStream,i,function(){}):t=readableStream.pipe(i),u=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0),f.prev=3,f.next=6,fromBuffer(u);case 6:r=f.sent,i.fileType=r,f.next=13;break;case 10:f.prev=10,f.t0=f.catch(3),reject(f.t0);case 13:resolve(t);case 14:case"end":return f.stop()}},m,null,[[3,10]])})))})},fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:function m(){return new Set(supported.extensions)}});Object.defineProperty(fileType,"mimeTypes",{get:function m(){return new Set(supported.mimeTypes)}});var core=fileType;(function(m){var i=lib$1.ReadableWebToNodeStream,t=core;function u(s){return r.apply(this,arguments)}function r(){return r=_asyncToGenerator(_regeneratorRuntime().mark(function s(d){var p,o;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return p=new i(d),l.next=3,t.fromStream(p);case 3:return o=l.sent,l.next=6,p.close();case 6:return l.abrupt("return",o);case 7:case"end":return l.stop()}},s)})),r.apply(this,arguments)}function a(s){return f.apply(this,arguments)}function f(){return f=_asyncToGenerator(_regeneratorRuntime().mark(function s(d){var p;return _regeneratorRuntime().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,n(d);case 2:return p=x.sent,x.abrupt("return",t.fromBuffer(Buffer.from(p)));case 4:case"end":return x.stop()}},s)})),f.apply(this,arguments)}function n(s){return s.arrayBuffer?s.arrayBuffer():new Promise(function(d,p){var o=new FileReader;o.addEventListener("loadend",function(x){d(x.target.result)}),o.addEventListener("error",function(x){p(new Error(x.message))}),o.addEventListener("abort",function(x){p(new Error(x.type))}),o.readAsArrayBuffer(s)})}Object.assign(m.exports,t,{fromStream:u,fromBlob:a})})(browser$2);var browser=browser$2.exports,browser$1=_mergeNamespaces({__proto__:null,default:browser},[browser$2.exports]);export{browser$1 as b};
